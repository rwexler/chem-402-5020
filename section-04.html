
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Real Gases &#8212; Physical Chemistry II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/myfile.css?v=536cf54f" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'section-04';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Physical Chemistry II - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Physical Chemistry II - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Physical Chemistry II
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1. Equations of State</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="section-01.html">1. Course Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-02.html">2. Kinetic Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-03.html">3. Ideal Gases</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fsection-04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/section-04.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Real Gases</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deviations-from-ideal-behavior">Deviations from Ideal Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compressibility-factor">Compressibility Factor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-fluid">Van der Waals Fluid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-equation-of-state">Van der Waals Equation of State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-isotherm">Van der Waals Isotherm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-point">Critical Point</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#corresponding-states">Corresponding States</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-van-der-waals-equation">The van der Waals Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-physical-meaning-of-a-and-b">Derivation &amp; Physical Meaning of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-idea">Key Idea</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematically">Mathematically</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-form">Alternative Form</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-phenomena-the-critical-point">Critical Phenomena &amp; the Critical Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concept">Key Concept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conditions-at-the-critical-point">Conditions at the Critical Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-insight">Physical Insight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-v-diagrams-phases-and-phase-transitions"><span class="math notranslate nohighlight">\(P\)</span>-<span class="math notranslate nohighlight">\(V\)</span> Diagrams: Phases and Phase Transitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons-ideal-vs-van-der-waals-behavior">Comparisons – Ideal vs. van der Waals Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gas">Ideal Gas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-gas">van der Waals Gas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-principle-of-corresponding-states">The Principle of Corresponding States</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#core-idea">Core Idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-van-der-waals-equation">Reduced van der Waals Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implication">Implication</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-key-takeaways">Summary &amp; Key Takeaways</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!-- Board 1: 4.1 & 4.2
Board 2: 4.3
Board 3: 4.4.1
Board 4: 4.4.2
Board 5: 4.4.2.1
Board 6: 4.4.2.2 -->
<section class="tex2jax_ignore mathjax_ignore" id="real-gases">
<h1>Real Gases<a class="headerlink" href="#real-gases" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>Under high pressures, high densities, or low temperatures, we cannot treat gases as sets of non-interacting point particles. Higher pressures imply more frequent collisions and higher densities, higher densities are associated with closer molecules that can more strongly interact and experience each other’s finite size, and lower temperatures indicate that molecules have lower kinetic energy and are more disposed to be affected by these interactions. This section presents approaches for quantifying deviations from ideal behavior and the van der Waals equation of state, which is one of the simplest models for real gases and the subject of the <a class="reference external" href="https://www.nobelprize.org/prizes/physics/1910/summary/">Nobel Prize in Physics 1910</a>.</p>
</section>
<section id="deviations-from-ideal-behavior">
<h2>Deviations from Ideal Behavior<a class="headerlink" href="#deviations-from-ideal-behavior" title="Link to this heading">#</a></h2>
<section id="compressibility-factor">
<h3>Compressibility Factor<a class="headerlink" href="#compressibility-factor" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

<span class="c1"># Experimental data for H2O at 300 K</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;_static/section-04/water_compressibility.csv&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">line1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$Z_</span><span class="se">\\</span><span class="s2">text</span><span class="si">{water}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">xlim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$Z_</span><span class="se">\\</span><span class="s2">text</span><span class="si">{ideal}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Interpolating to find the intersection more accurately</span>
<span class="n">interp_Z</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
<span class="n">intersection_pressure</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">intersection_Z</span> <span class="o">=</span> <span class="n">interp_Z</span><span class="p">(</span><span class="n">intersection_pressure</span><span class="p">)</span>

<span class="c1"># Find the pressure and Z value at which Z is minimized for the real gas</span>
<span class="n">min_Z_index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>  <span class="c1"># Index of the minimum Z value</span>
<span class="n">min_pressure</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_Z_index</span><span class="p">,</span> <span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">]</span>  <span class="c1"># Pressure corresponding to the minimum Z</span>
<span class="n">min_Z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_Z_index</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]</span>  <span class="c1"># Minimum Z value</span>

<span class="n">x_ideal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_pressure</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Ideal&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_ideal</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">x_coincidentally_ideal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Coincidentally</span><span class="se">\n</span><span class="s2">ideal&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_coincidentally_ideal</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">x_attractive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">intersection_pressure</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_attractive</span><span class="p">,</span> <span class="n">min_Z</span><span class="p">,</span> <span class="s2">&quot;Attractive&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_coincidentally_ideal</span><span class="p">,</span> <span class="n">min_Z</span><span class="p">,</span> <span class="s2">&quot;Repulsive&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="c1"># Adjust limits and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;compressibility-factor&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="id1" style="width: 100%">
<img alt="_images/e3a269ad94542ed8f65eb34f6254cb036a2a7bb07f0c82d7ec7bf5f9dbe5b897.png" src="_images/e3a269ad94542ed8f65eb34f6254cb036a2a7bb07f0c82d7ec7bf5f9dbe5b897.png" />
<figcaption>
<p><span class="caption-text">Hello, world!</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>One of the ways to quantify deviations from ideal behavior is by way of the compressibility factor <span class="math notranslate nohighlight">\(Z\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-compressibility-factor">
<span class="eqno">()<a class="headerlink" href="#equation-compressibility-factor" title="Link to this equation">#</a></span>\[Z = \frac{P V}{N k_\text{B} T} = \frac{P V}{n R T}.\]</div>
<p>Imagine that you are measuring the volume of a gas at a sequence of pressures and constant temperature. If the gas behaves ideally, <span class="math notranslate nohighlight">\(V = N k_\text{B} T / P\)</span>, and so <span class="math notranslate nohighlight">\(Z = 1\)</span>. If the gas deviates from ideal behavior, <span class="math notranslate nohighlight">\(Z\)</span> will differ from 1.</p>
</section>
</section>
<section id="van-der-waals-fluid">
<h2>Van der Waals Fluid<a class="headerlink" href="#van-der-waals-fluid" title="Link to this heading">#</a></h2>
<section id="van-der-waals-equation-of-state">
<h3>Van der Waals Equation of State<a class="headerlink" href="#van-der-waals-equation-of-state" title="Link to this heading">#</a></h3>
<p>Hello, world!</p>
</section>
<section id="van-der-waals-isotherm">
<h3>Van der Waals Isotherm<a class="headerlink" href="#van-der-waals-isotherm" title="Link to this heading">#</a></h3>
<p>Hello, world!</p>
<section id="critical-point">
<h4>Critical Point<a class="headerlink" href="#critical-point" title="Link to this heading">#</a></h4>
<p>Hello, world!</p>
</section>
<section id="corresponding-states">
<h4>Corresponding States<a class="headerlink" href="#corresponding-states" title="Link to this heading">#</a></h4>
<p>Hello, world!</p>
<!-- # Real Gases & Equations of State I -->
</section>
</section>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In our previous lectures, we considered ideal gases, which assume non-interacting, point-like particles. This approximation works remarkably well at low pressures and high temperatures but fails to describe gases near condensation conditions. Here, we begin our study of <strong>real gases</strong>, which deviate from ideality due to two key effects:</p>
<ol class="arabic simple">
<li><p>Gas particles have finite size.</p></li>
<li><p>Gas particles interact with each other (attractive and repulsive forces).</p></li>
</ol>
<p>We focus on the <strong>van der Waals (vdW) equation of state</strong>, a simple yet instructive model that incorporates these real-gas features. This equation accurately reproduces qualitative aspects such as non-ideal behavior, phase transitions from gas to liquid, and the existence of a critical point.</p>
</section>
<hr class="docutils" />
<section id="the-van-der-waals-equation">
<h2>The van der Waals Equation<a class="headerlink" href="#the-van-der-waals-equation" title="Link to this heading">#</a></h2>
<section id="derivation-physical-meaning-of-a-and-b">
<h3>Derivation &amp; Physical Meaning of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span><a class="headerlink" href="#derivation-physical-meaning-of-a-and-b" title="Link to this heading">#</a></h3>
<section id="key-idea">
<h4>Key Idea<a class="headerlink" href="#key-idea" title="Link to this heading">#</a></h4>
<p>The van der Waals equation modifies the ideal gas law <span class="math notranslate nohighlight">\(P V_m = R T\)</span> by correcting for particle size and intermolecular attractions.</p>
<ul class="simple">
<li><p><strong>Finite Particle Size Correction</strong>: The parameter <span class="math notranslate nohighlight">\(b\)</span> accounts for the <strong>excluded volume</strong> per mole due to the finite size of molecules. Since real gas particles occupy space, the available volume for molecular motion is less than the total container volume.</p></li>
<li><p><strong>Intermolecular Attraction Correction</strong>: The parameter <span class="math notranslate nohighlight">\(a\)</span> corrects the pressure for the attractive forces between molecules. Attractive interactions effectively reduce the momentum transfer to the walls and hence the measured pressure.</p></li>
</ul>
</section>
<section id="mathematically">
<h4>Mathematically<a class="headerlink" href="#mathematically" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
\left(P + \frac{a}{V_m^2}\right)(V_m - b) = R T
\]</div>
<p>where <span class="math notranslate nohighlight">\(V_m\)</span> is the molar volume.</p>
</section>
<section id="interpretation">
<h4>Interpretation<a class="headerlink" href="#interpretation" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Increasing <span class="math notranslate nohighlight">\(a\)</span>: stronger intermolecular attractions.</p></li>
<li><p>Increasing <span class="math notranslate nohighlight">\(b\)</span>: larger molecular size, reducing the free volume.</p></li>
</ul>
</section>
</section>
<section id="alternative-form">
<h3>Alternative Form<a class="headerlink" href="#alternative-form" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
P = \frac{R T}{V_m - b} - \frac{a}{V_m^2}
\]</div>
<p>This rearrangement shows the balance between a repulsive term <span class="math notranslate nohighlight">\(RT/(V_m - b)\)</span> and an attractive term <span class="math notranslate nohighlight">\(a/V_m^2\)</span>.</p>
</section>
</section>
<hr class="docutils" />
<section id="critical-phenomena-the-critical-point">
<h2>Critical Phenomena &amp; the Critical Point<a class="headerlink" href="#critical-phenomena-the-critical-point" title="Link to this heading">#</a></h2>
<section id="key-concept">
<h3>Key Concept<a class="headerlink" href="#key-concept" title="Link to this heading">#</a></h3>
<p>As temperature and pressure increase, the distinction between liquid and gas phases blurs. At a specific combination of temperature (<span class="math notranslate nohighlight">\(T_c\)</span>), pressure (<span class="math notranslate nohighlight">\(P_c\)</span>), and volume (<span class="math notranslate nohighlight">\(V_{m,c}\)</span>), the system reaches the <strong>critical point</strong>. Beyond the critical point, there is no longer a clear boundary between the liquid and gaseous states—only a supercritical fluid remains.</p>
</section>
<section id="conditions-at-the-critical-point">
<h3>Conditions at the Critical Point<a class="headerlink" href="#conditions-at-the-critical-point" title="Link to this heading">#</a></h3>
<p>From the van der Waals equation, applying conditions for the critical point yields:</p>
<div class="math notranslate nohighlight">
\[
V_{m,c} = 3b, \quad P_c = \frac{a}{27 b^2}, \quad T_c = \frac{8a}{27 R b}.
\]</div>
<p>At <span class="math notranslate nohighlight">\((P_c, V_{m,c}, T_c)\)</span>, the first and second derivatives of <span class="math notranslate nohighlight">\(P\)</span> with respect to <span class="math notranslate nohighlight">\(V_m\)</span> vanish. This mathematical condition corresponds to the inflection point on the critical isotherm.</p>
<div class="dropdown admonition">
<p class="admonition-title">Derivation of Critical Conditions</p>
<p>To find the critical point <span class="math notranslate nohighlight">\(\left(P_c, V_{m,c}, T_c\right)\)</span> for a van der Waals gas, we use two conditions on the isotherm at <span class="math notranslate nohighlight">\(\,T = T_c\)</span>:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\left.\left(\frac{\partial P}{\partial V_m}\right)_{T}\right|_{V_{m,c}} = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\left.\left(\frac{\partial^2 P}{\partial V_m^2}\right)_{T}\right|_{V_{m,c}} = 0\)</span></p></li>
</ol>
<p>where the pressure <span class="math notranslate nohighlight">\(P\)</span> is given by the van der Waals equation:</p>
<div class="math notranslate nohighlight">
\[
P = \frac{R T}{\,V_m - b\,} \;-\; \frac{a}{\,V_m^2\,}.
\]</div>
<hr class="docutils" />
<p><strong>Step 1: First Derivative Condition</strong></p>
<div class="math notranslate nohighlight">
\[
\left.\left(\frac{\partial P}{\partial V_m}\right)_{T}\right|_{V_{m,c}} 
\;=\;
\left.\frac{\partial}{\partial V_m}
\left[\tfrac{R T}{\,V_m - b\,} - \tfrac{a}{\,V_m^2\,}\right]
\right|_{V_{m,c}}
\;=\; 0.
\]</div>
<p>Compute each term’s derivative with respect to <span class="math notranslate nohighlight">\(V_m\)</span>:</p>
<ul>
<li><p>For <span class="math notranslate nohighlight">\(\tfrac{R T}{\,V_m - b\,}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\partial}{\partial V_m} \left(\frac{R T}{V_m - b}\right)
  = -\,\frac{R T}{\,(V_m - b)^2\,}.
  \]</div>
</li>
<li><p>For <span class="math notranslate nohighlight">\(\tfrac{a}{\,V_m^2\,}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  \frac{\partial}{\partial V_m} \left(\frac{a}{\,V_m^2}\right)
  = -\,\frac{2\,a}{\,V_m^3\,}.
  \]</div>
</li>
</ul>
<p>So the first derivative is:</p>
<div class="math notranslate nohighlight">
\[
\left.\left(\frac{\partial P}{\partial V_m}\right)_{T}\right|_{V_{m,c}}
= -\,\frac{R T_c}{\,(V_{m,c} - b)^2\,} \;+\; \frac{2\,a}{\,V_{m,c}^3\,}
= 0.
\]</div>
<p>Rearranging yields:</p>
<div class="math notranslate nohighlight">
\[
\frac{R T_c}{\,(V_{m,c} - b)^2\,}
= \frac{2\,a}{\,V_{m,c}^3\,}.
\]</div>
<hr class="docutils" />
<p><strong>Step 2: Second Derivative Condition</strong></p>
<div class="math notranslate nohighlight">
\[
\left.\left(\frac{\partial^2 P}{\partial V_m^2}\right)_{T}\right|_{V_{m,c}}
= 0.
\]</div>
<p>Starting again from <span class="math notranslate nohighlight">\(P = \tfrac{R T}{\,V_m - b\,} - \tfrac{a}{\,V_m^2\,}\)</span>, we take the second derivative:</p>
<ol class="arabic">
<li><p>The derivative of <span class="math notranslate nohighlight">\(-\,\tfrac{R T}{\,(V_m - b)^2\,}\)</span> with respect to <span class="math notranslate nohighlight">\(V_m\)</span>:</p>
<div class="math notranslate nohighlight">
\[
   \frac{\partial}{\partial V_m} 
   \left(-\frac{R T}{\,(V_m - b)^2}\right)
   = 2 \,\frac{R T}{\,(V_m - b)^3\,}.
   \]</div>
</li>
<li><p>The derivative of <span class="math notranslate nohighlight">\(\tfrac{2\,a}{\,V_m^3\,}\)</span> with respect to <span class="math notranslate nohighlight">\(V_m\)</span>:</p>
<div class="math notranslate nohighlight">
\[
   \frac{\partial}{\partial V_m} \left(\frac{2\,a}{\,V_m^3}\right)
   = -\,\frac{6\,a}{\,V_m^4\,}.
   \]</div>
</li>
</ol>
<p>Hence,</p>
<div class="math notranslate nohighlight">
\[
\left.\left(\frac{\partial^2 P}{\partial V_m^2}\right)_{T}\right|_{V_{m,c}}
= 2\,\frac{R T_c}{\,(V_{m,c} - b)^3\,} \;-\; \frac{6\,a}{\,V_{m,c}^4\,}
= 0.
\]</div>
<p>Rearranging gives:</p>
<div class="math notranslate nohighlight">
\[
\frac{2\,R T_c}{\,(V_{m,c} - b)^3\,}
= \frac{6\,a}{\,V_{m,c}^4\,}.
\]</div>
<hr class="docutils" />
<p><strong>Step 3: Solving Simultaneously</strong></p>
<p>We now have two equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\frac{R T_c}{(V_{m,c} - b)^2} &amp;= \frac{2\,a}{V_{m,c}^3}, \\
\frac{2\,R T_c}{(V_{m,c} - b)^3} &amp;= \frac{6\,a}{V_{m,c}^4}.
\end{aligned}
\end{split}\]</div>
<p>Divide the second equation by the first to eliminate <span class="math notranslate nohighlight">\(R T_c\)</span> and <span class="math notranslate nohighlight">\(a\)</span>. Simplifying yields:</p>
<div class="math notranslate nohighlight">
\[
\frac{\left(V_{m,c} - b\right)^2}{\left(V_{m,c} - b\right)^3}
= \frac{2\,V_{m,c}^3}{\,6\,V_{m,c}^4\,} \quad\Longrightarrow\quad
\frac{1}{\,V_{m,c} - b\,}
= \frac{1}{\,3\,V_{m,c}\,}.
\]</div>
<p>Thus <span class="math notranslate nohighlight">\(V_{m,c} = 3\,b\)</span>. Substituting <span class="math notranslate nohighlight">\(V_{m,c} = 3b\)</span> back into the first derivative condition determines <span class="math notranslate nohighlight">\(T_c\)</span> and then <span class="math notranslate nohighlight">\(P_c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
T_c = \frac{8\,a}{\,27\,R\,b}, 
\quad
P_c = \frac{a}{\,27\,b^2}.
\]</div>
<p><strong>Result:</strong></p>
<div class="math notranslate nohighlight">
\[
\boxed{
V_{m,c} \;=\; 3\,b, \quad
T_c \;=\; \frac{8\,a}{27\,R\,b}, \quad
P_c \;=\; \frac{a}{27\,b^2}.
}
\]</div>
<p>These formulas express the van der Waals critical volume, temperature, and pressure in terms of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
</div>
<hr class="docutils" />
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Set plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-colorblind&#39;</span><span class="p">)</span>

<span class="c1"># Increase font size for better readability</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>

<span class="c1"># Gas constant in L·bar/(K·mol)</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">0.08314</span>  

<span class="c1"># Van der Waals parameters for Helium</span>
<span class="n">a_He</span> <span class="o">=</span> <span class="mf">0.0346</span>   <span class="c1"># L²·bar/mol²</span>
<span class="n">b_He</span> <span class="o">=</span> <span class="mf">0.0238</span>   <span class="c1"># L/mol</span>

<span class="k">def</span><span class="w"> </span><span class="nf">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the van der Waals pressure for given parameters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : float</span>
<span class="sd">        Attraction parameter (L²·bar/mol²).</span>
<span class="sd">    b : float</span>
<span class="sd">        Excluded volume parameter (L/mol).</span>
<span class="sd">    T : float</span>
<span class="sd">        Temperature (K).</span>
<span class="sd">    V : ndarray</span>
<span class="sd">        Molar volume array (L/mol).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray</span>
<span class="sd">        Pressure in bar for each volume.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_vdw_isotherms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot van der Waals isotherms for temperatures ranging from 0.8 T_c to 1.2 T_c.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        The axes on which to plot.</span>
<span class="sd">    a, b : float</span>
<span class="sd">        van der Waals parameters.</span>
<span class="sd">    Tc, Pc, Vc : float</span>
<span class="sd">        Critical temperature, pressure, and molar volume.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reduced temperature range</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="c1"># Reduced volume range</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Actual T and V arrays</span>
    <span class="n">T_vals</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">*</span> <span class="n">Tr</span>
    <span class="n">V_vals</span> <span class="o">=</span> <span class="n">Vc</span> <span class="o">*</span> <span class="n">Vr</span>

    <span class="c1"># Plot each isotherm</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">T_vals</span><span class="p">):</span>
        <span class="n">P_vals</span> <span class="o">=</span> <span class="n">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T_i</span><span class="p">,</span> <span class="n">V_vals</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V_vals</span><span class="p">,</span> <span class="n">P_vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;vdW: $T = </span><span class="si">{</span><span class="n">Tr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">\,T_c$&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">Pc</span><span class="p">,</span> <span class="mf">2.6</span> <span class="o">*</span> <span class="n">Pc</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$V_m$ (L/mol)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P$ (bar)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Create a figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Load experimental data for Helium</span>
<span class="n">df_He</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;_static/lecture-04/He_data.xlsx&quot;</span><span class="p">)</span>

<span class="c1"># Plot experimental data at ~0.8 T_c</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">],</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> 
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Experiment, $T </span><span class="se">\\</span><span class="s2">approx 0.8\,T_c$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="c1"># Compute critical constants for Helium</span>
<span class="n">Tc_He</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a_He</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">b_He</span><span class="p">)</span>
<span class="n">Pc_He</span> <span class="o">=</span> <span class="n">a_He</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_He</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Vc_He</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b_He</span>

<span class="c1"># Plot theoretical van der Waals isotherms</span>
<span class="n">plot_vdw_isotherms</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a_He</span><span class="p">,</span> <span class="n">b_He</span><span class="p">,</span> <span class="n">Tc_He</span><span class="p">,</span> <span class="n">Pc_He</span><span class="p">,</span> <span class="n">Vc_He</span><span class="p">)</span>

<span class="c1"># Save figure for later embedding with myst_nb&#39;s glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vdw_isotherms&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Close figure to prevent duplicate display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">77</span>
<span class="g g-Whitespace">     </span><span class="mi">74</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">76</span> <span class="c1"># Load experimental data for Helium</span>
<span class="ne">---&gt; </span><span class="mi">77</span> <span class="n">df_He</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;_static/lecture-04/He_data.xlsx&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">79</span> <span class="c1"># Plot experimental data at ~0.8 T_c</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">],</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> 
<span class="g g-Whitespace">     </span><span class="mi">81</span>             <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Experiment, $T </span><span class="se">\\</span><span class="s2">approx 0.8\,T_c$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/pandas/io/excel/_base.py:478,</span> in <span class="ni">read_excel</span><span class="nt">(io, sheet_name, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, date_format, thousands, decimal, comment, skipfooter, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">    </span><span class="mi">476</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">ExcelFile</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">477</span>     <span class="n">should_close</span> <span class="o">=</span> <span class="kc">True</span>
<span class="ne">--&gt; </span><span class="mi">478</span>     <span class="n">io</span> <span class="o">=</span> <span class="n">ExcelFile</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">479</span> <span class="k">elif</span> <span class="n">engine</span> <span class="ow">and</span> <span class="n">engine</span> <span class="o">!=</span> <span class="n">io</span><span class="o">.</span><span class="n">engine</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">481</span>         <span class="s2">&quot;Engine should not be specified when passing &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">482</span>         <span class="s2">&quot;an ExcelFile - ExcelFile already has the engine set&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span>     <span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/pandas/io/excel/_base.py:1496,</span> in <span class="ni">ExcelFile.__init__</span><span class="nt">(self, path_or_buffer, engine, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1494</span>     <span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;xls&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1495</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1496</span>     <span class="n">ext</span> <span class="o">=</span> <span class="n">inspect_excel_format</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1497</span>         <span class="n">content_or_path</span><span class="o">=</span><span class="n">path_or_buffer</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span>
<span class="g g-Whitespace">   </span><span class="mi">1498</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1499</span>     <span class="k">if</span> <span class="n">ext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1500</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1501</span>             <span class="s2">&quot;Excel file format cannot be determined, you must specify &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1502</span>             <span class="s2">&quot;an engine manually.&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1503</span>         <span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/pandas/io/excel/_base.py:1371,</span> in <span class="ni">inspect_excel_format</span><span class="nt">(content_or_path, storage_options)</span>
<span class="g g-Whitespace">   </span><span class="mi">1368</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">content_or_path</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1369</span>     <span class="n">content_or_path</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">content_or_path</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1371</span> <span class="k">with</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1372</span>     <span class="n">content_or_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">,</span> <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span> <span class="n">is_text</span><span class="o">=</span><span class="kc">False</span>
<span class="g g-Whitespace">   </span><span class="mi">1373</span> <span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1374</span>     <span class="n">stream</span> <span class="o">=</span> <span class="n">handle</span><span class="o">.</span><span class="n">handle</span>
<span class="g g-Whitespace">   </span><span class="mi">1375</span>     <span class="n">stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/pandas/io/common.py:868,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">860</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">861</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">867</span>         <span class="c1"># Binary mode</span>
<span class="ne">--&gt; </span><span class="mi">868</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="n">handles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span> <span class="c1"># Convert BytesIO or file objects passed with an encoding</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;_static/lecture-04/He_data.xlsx&#39;
</pre></div>
</div>
<img alt="_images/513a27a559e7fe4acceda8264003a15371ab52f4257c305afda86d706eefa9ab.png" src="_images/513a27a559e7fe4acceda8264003a15371ab52f4257c305afda86d706eefa9ab.png" />
</div>
</div>
</section>
<section id="physical-insight">
<h3>Physical Insight<a class="headerlink" href="#physical-insight" title="Link to this heading">#</a></h3>
<p>At <span class="math notranslate nohighlight">\(T &lt; T_c\)</span>, isotherms show non-ideal behavior with regions corresponding to phase coexistence (plateaus where liquid and gas are in equilibrium). At <span class="math notranslate nohighlight">\(T = T_c\)</span>, the isotherm has a point of inflection. For <span class="math notranslate nohighlight">\(T &gt; T_c\)</span>, there are no phase boundaries.</p>
</section>
</section>
<hr class="docutils" />
<section id="p-v-diagrams-phases-and-phase-transitions">
<h2><span class="math notranslate nohighlight">\(P\)</span>-<span class="math notranslate nohighlight">\(V\)</span> Diagrams: Phases and Phase Transitions<a class="headerlink" href="#p-v-diagrams-phases-and-phase-transitions" title="Link to this heading">#</a></h2>
<p>In <span class="math notranslate nohighlight">\(P\)</span>-<span class="math notranslate nohighlight">\(V\)</span> diagrams at constant temperature, the <strong>van der Waals isotherms</strong> can exhibit a non-monotonic region where a naive application would predict negative compressibility. Physical systems avoid this instability by undergoing phase separation into coexisting liquid and gas phases. The equal-area Maxwell construction (discussed in detail in later lectures) addresses this.</p>
<p>Below the critical temperature (<span class="math notranslate nohighlight">\(T &lt; T_c\)</span>), the isotherm has three segments:</p>
<ul class="simple">
<li><p>A low-pressure, large-volume (gas) region.</p></li>
<li><p>A middle, unstable region.</p></li>
<li><p>A high-pressure, small-volume (liquid) region.</p></li>
</ul>
<p>At equilibrium, the system is a mixture of liquid and gas with a flat <span class="math notranslate nohighlight">\(P\)</span>-<span class="math notranslate nohighlight">\(V\)</span> tie line. At exactly <span class="math notranslate nohighlight">\(T = T_c\)</span>, these two distinct phases merge.</p>
<hr class="docutils" />
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Set plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-colorblind&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>

<span class="c1"># Gas constant in L·bar/(K·mol)</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">0.08314</span>  

<span class="c1"># Van der Waals parameters for Helium</span>
<span class="n">a_He</span> <span class="o">=</span> <span class="mf">0.0346</span>   <span class="c1"># L²·bar/mol²</span>
<span class="n">b_He</span> <span class="o">=</span> <span class="mf">0.0238</span>   <span class="c1"># L/mol</span>

<span class="k">def</span><span class="w"> </span><span class="nf">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the van der Waals pressure for given parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Load experimental data for Helium</span>
<span class="n">df_He</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;_static/lecture-04/He_data.xlsx&quot;</span><span class="p">)</span>

<span class="c1"># Identify discontinuities to show phase boundaries</span>
<span class="n">dPdV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">])</span>
<span class="n">discontinuities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dPdV</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot the experimental data in black</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">],</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="c1"># Add vertical lines at approximate phase boundaries</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="p">[</span><span class="n">discontinuities</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">discontinuities</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>

<span class="c1"># Apply log scales</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>

<span class="c1"># Label axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$V_m$ (L/mol)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P$ (bar)&quot;</span><span class="p">)</span>

<span class="c1"># Annotate liquid/gas volumes</span>
<span class="n">V_l</span> <span class="o">=</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">][</span><span class="n">discontinuities</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">V_g</span> <span class="o">=</span> <span class="n">df_He</span><span class="p">[</span><span class="s2">&quot;Volume (l/mol)&quot;</span><span class="p">][</span><span class="n">discontinuities</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">P_text_min</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.1</span>
<span class="n">P_text_max</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V_l</span><span class="p">,</span> <span class="n">P_text_min</span><span class="p">,</span> <span class="s2">&quot;$\leftarrow$ liquid&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V_l</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">P_text_max</span><span class="p">,</span> 
        <span class="sa">rf</span><span class="s2">&quot;$V_m = </span><span class="si">{</span><span class="n">V_l</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\,\mathrm</span><span class="se">{{</span><span class="s2">L/mol</span><span class="se">}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">V_l</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b_He</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\,b$&quot;</span><span class="p">,</span> 
        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V_g</span><span class="p">,</span> <span class="n">P_text_min</span><span class="p">,</span> <span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">rightarrow$ gas&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">V_g</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">P_text_max</span><span class="p">,</span> 
        <span class="sa">rf</span><span class="s2">&quot;$V_g = </span><span class="si">{</span><span class="n">V_g</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\,\mathrm</span><span class="se">{{</span><span class="s2">L/mol</span><span class="se">}}</span><span class="s2"> = </span><span class="si">{</span><span class="n">V_g</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">b_He</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">\,b$&quot;</span><span class="p">,</span> 
        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">mid_label</span> <span class="o">=</span> <span class="p">(</span><span class="n">V_l</span> <span class="o">+</span> <span class="n">V_g</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mid_label</span><span class="p">,</span> <span class="n">P_text_min</span><span class="p">,</span> <span class="s2">&quot;liquid-gas mixture&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="c1"># Save figure for later embedding with myst_nb&#39;s glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vdw_phase_diagram&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Close figure to prevent duplicate display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<hr class="docutils" />
<section id="comparisons-ideal-vs-van-der-waals-behavior">
<h2>Comparisons – Ideal vs. van der Waals Behavior<a class="headerlink" href="#comparisons-ideal-vs-van-der-waals-behavior" title="Link to this heading">#</a></h2>
<section id="ideal-gas">
<h3>Ideal Gas<a class="headerlink" href="#ideal-gas" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
P V = R T \quad \Rightarrow \quad P = \frac{R T}{V_m}.
\]</div>
<p>This simple linear relationship in <span class="math notranslate nohighlight">\(1/V_m\)</span> ignores both molecular volume and intermolecular forces. As a result, ideal isotherms never show a phase transition. The ideal gas law breaks down near condensation conditions.</p>
</section>
<section id="van-der-waals-gas">
<h3>van der Waals Gas<a class="headerlink" href="#van-der-waals-gas" title="Link to this heading">#</a></h3>
<p>Incorporating <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>:</p>
<ul class="simple">
<li><p>Predicts non-ideal behavior at high pressures and/or low temperatures.</p></li>
<li><p>Captures the existence of a critical point and the qualitative features of phase transitions.</p></li>
<li><p>Reduces to ideal behavior in the limit <span class="math notranslate nohighlight">\(a \to 0\)</span> and <span class="math notranslate nohighlight">\(b \to 0\)</span>.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="the-principle-of-corresponding-states">
<h2>The Principle of Corresponding States<a class="headerlink" href="#the-principle-of-corresponding-states" title="Link to this heading">#</a></h2>
<section id="core-idea">
<h3>Core Idea<a class="headerlink" href="#core-idea" title="Link to this heading">#</a></h3>
<p>All fluids, when compared at corresponding states (same reduced temperature <span class="math notranslate nohighlight">\(T_r = T/T_c\)</span>, reduced pressure <span class="math notranslate nohighlight">\(P_r = P/P_c\)</span>, and reduced volume <span class="math notranslate nohighlight">\(V_{m,r} = V_m/V_{m,c}\)</span>), exhibit similar behavior. This is known as the <strong>principle of corresponding states</strong>.</p>
</section>
<section id="reduced-van-der-waals-equation">
<h3>Reduced van der Waals Equation<a class="headerlink" href="#reduced-van-der-waals-equation" title="Link to this heading">#</a></h3>
<p>By dividing <span class="math notranslate nohighlight">\(P\)</span>, <span class="math notranslate nohighlight">\(V_m\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> by their critical values, we can rewrite the vdW equation in a universal form:</p>
<div class="math notranslate nohighlight">
\[
\boxed{\left(P_r + \frac{3}{V_{m,r}^2}\right) (V_{m,r} - \tfrac{1}{3}) = \tfrac{8}{3} T_r.}
\]</div>
</section>
<section id="implication">
<h3>Implication<a class="headerlink" href="#implication" title="Link to this heading">#</a></h3>
<p>Once you know the critical constants of one fluid, you can predict the qualitative behavior of all others simply by using the reduced variables. Thus, helium and benzene, despite their vast differences, follow the same pattern when scaled by their critical values.</p>
<hr class="docutils" />
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Set plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-colorblind&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>

<span class="c1"># Gas constant in L·bar/(K·mol)</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">0.08314</span>  

<span class="c1"># van der Waals parameters for Helium</span>
<span class="n">a_He</span> <span class="o">=</span> <span class="mf">0.0346</span>    <span class="c1"># L²·bar/mol²</span>
<span class="n">b_He</span> <span class="o">=</span> <span class="mf">0.0238</span>    <span class="c1"># L/mol</span>

<span class="c1"># van der Waals parameters for Benzene</span>
<span class="n">a_Benzene</span> <span class="o">=</span> <span class="mf">18.24</span>   <span class="c1"># L²·bar/mol²</span>
<span class="n">b_Benzene</span> <span class="o">=</span> <span class="mf">0.1193</span>  <span class="c1"># L/mol</span>

<span class="k">def</span><span class="w"> </span><span class="nf">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the van der Waals pressure for given parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_reduced_isotherms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">Tc</span><span class="p">,</span> <span class="n">Pc</span><span class="p">,</span> <span class="n">Vc</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot reduced van der Waals isotherms (Pr vs. Vr) for T = 0.8-1.2 T_c.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">        Axis on which to plot.</span>
<span class="sd">    a, b : float</span>
<span class="sd">        van der Waals parameters.</span>
<span class="sd">    Tc, Pc, Vc : float</span>
<span class="sd">        Critical temperature, pressure, and volume.</span>
<span class="sd">    label : str</span>
<span class="sd">        Label for the substance in the legend.</span>
<span class="sd">    linestyle : str, optional</span>
<span class="sd">        Line style for the isotherms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Reduced T and V ranges</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">Vr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="c1"># Loop over each reduced temperature</span>
    <span class="k">for</span> <span class="n">T_val</span> <span class="ow">in</span> <span class="n">Tr</span><span class="p">:</span>
        <span class="c1"># Actual T and V</span>
        <span class="n">T_actual</span> <span class="o">=</span> <span class="n">Tc</span> <span class="o">*</span> <span class="n">T_val</span>
        <span class="n">V_actual</span> <span class="o">=</span> <span class="n">Vc</span> <span class="o">*</span> <span class="n">Vr</span>

        <span class="c1"># Calculate van der Waals pressure</span>
        <span class="n">P_vals</span> <span class="o">=</span> <span class="n">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T_actual</span><span class="p">,</span> <span class="n">V_actual</span><span class="p">)</span>
        <span class="n">P_reduced</span> <span class="o">=</span> <span class="n">P_vals</span> <span class="o">/</span> <span class="n">Pc</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vr</span><span class="p">,</span> <span class="n">P_reduced</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">, $T = </span><span class="si">{</span><span class="n">T_val</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">\,T_c$&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$V_{m,r}$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P_r$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Critical constants for Helium</span>
<span class="n">Tc_He</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a_He</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">b_He</span><span class="p">)</span>
<span class="n">Pc_He</span> <span class="o">=</span> <span class="n">a_He</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_He</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Vc_He</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b_He</span>

<span class="c1"># Critical constants for Benzene</span>
<span class="n">Tc_Benzene</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a_Benzene</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">R</span> <span class="o">*</span> <span class="n">b_Benzene</span><span class="p">)</span>
<span class="n">Pc_Benzene</span> <span class="o">=</span> <span class="n">a_Benzene</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_Benzene</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Vc_Benzene</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b_Benzene</span>

<span class="c1"># Plot Helium in reduced coordinates</span>
<span class="n">plot_reduced_isotherms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">a_He</span><span class="p">,</span> <span class="n">b_He</span><span class="p">,</span> <span class="n">Tc_He</span><span class="p">,</span> <span class="n">Pc_He</span><span class="p">,</span> <span class="n">Vc_He</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">)</span>

<span class="c1"># Plot Benzene in reduced coordinates</span>
<span class="n">plot_reduced_isotherms</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">a_Benzene</span><span class="p">,</span> <span class="n">b_Benzene</span><span class="p">,</span> <span class="n">Tc_Benzene</span><span class="p">,</span> <span class="n">Pc_Benzene</span><span class="p">,</span>
                       <span class="n">Vc_Benzene</span><span class="p">,</span> <span class="s2">&quot;Benzene&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">2.6</span><span class="p">)</span>

<span class="c1"># Save figure for later embedding with myst_nb&#39;s glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;vdw_reduced_isotherms&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Close figure to prevent duplicate display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<!-- **Estimating Molecular Sizes**:
From $b$, one can infer a characteristic molecular volume and thus estimate particle diameters. These estimates (e.g., ~3.4 Å for He, ~5.8 Å for benzene) agree reasonably well with typical molecular dimensions. -->
</section>
</section>
<hr class="docutils" />
<section id="summary-key-takeaways">
<h2>Summary &amp; Key Takeaways<a class="headerlink" href="#summary-key-takeaways" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>van der Waals EoS</strong>: Incorporates finite size (parameter <span class="math notranslate nohighlight">\(b\)</span>) and intermolecular attractions (parameter <span class="math notranslate nohighlight">\(a\)</span>).</p></li>
<li><p><strong>Critical Point</strong>: Marks the end of the liquid-gas coexistence curve. Derived conditions give <span class="math notranslate nohighlight">\(V_{m,c}, P_c, T_c\)</span> in terms of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p></li>
<li><p><strong>Phase Behavior</strong>: vdW isotherms predict liquid-gas phase transitions below <span class="math notranslate nohighlight">\(T_c\)</span> and supercritical fluids above <span class="math notranslate nohighlight">\(T_c\)</span>.</p></li>
<li><p><strong>Corresponding States</strong>: Rescaling by critical properties yields universal behavior for all substances. This highlights the generality of the van der Waals form and guides the prediction of properties of unknown fluids by analogy.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deviations-from-ideal-behavior">Deviations from Ideal Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compressibility-factor">Compressibility Factor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-fluid">Van der Waals Fluid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-equation-of-state">Van der Waals Equation of State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-isotherm">Van der Waals Isotherm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-point">Critical Point</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#corresponding-states">Corresponding States</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-van-der-waals-equation">The van der Waals Equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#derivation-physical-meaning-of-a-and-b">Derivation &amp; Physical Meaning of <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#key-idea">Key Idea</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematically">Mathematically</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-form">Alternative Form</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-phenomena-the-critical-point">Critical Phenomena &amp; the Critical Point</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concept">Key Concept</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conditions-at-the-critical-point">Conditions at the Critical Point</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#physical-insight">Physical Insight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-v-diagrams-phases-and-phase-transitions"><span class="math notranslate nohighlight">\(P\)</span>-<span class="math notranslate nohighlight">\(V\)</span> Diagrams: Phases and Phase Transitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparisons-ideal-vs-van-der-waals-behavior">Comparisons – Ideal vs. van der Waals Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gas">Ideal Gas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-gas">van der Waals Gas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-principle-of-corresponding-states">The Principle of Corresponding States</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#core-idea">Core Idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reduced-van-der-waals-equation">Reduced van der Waals Equation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implication">Implication</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-key-takeaways">Summary &amp; Key Takeaways</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert B. Wexler
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>