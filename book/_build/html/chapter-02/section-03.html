
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.3. Ensemble Averages &#8212; Physical Chemistry II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=536cf54f" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter-02/section-03';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Appendix A. Differential Calculus" href="../appendices/appendix-a.html" />
    <link rel="prev" title="2.2. Canonical Ensemble" href="section-02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Physical Chemistry II - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Physical Chemistry II - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Physical Chemistry II
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1. Equations of State</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-01.html">1.1. Course Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-02.html">1.2. Kinetic Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-03.html">1.3. Ideal Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/section-04.html">1.4. Real Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-01/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 2. Statistical Mechanics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="section-01.html">2.1. Introduction to Statistical Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-02.html">2.2. Canonical Ensemble</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">2.3. Ensemble Averages</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/appendix-a.html">Appendix A. Differential Calculus</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter-02/section-03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter-02/section-03.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2.3. Ensemble Averages</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-equilibrium">Thermodynamic Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-energy">Internal Energy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-derivative-of-the-partition-function-with-respect-to-beta">Partial Derivative of the Partition Function with Respect to <span class="math notranslate nohighlight">\(\beta\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-energy-of-a-two-state-system">Internal Energy of a Two-State System</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-capacity-at-constant-volume">Heat Capacity at Constant Volume</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ensemble-averages">
<h1>2.3. Ensemble Averages<a class="headerlink" href="#ensemble-averages" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In Section 2.1, we introduced the idea that “macroscopic properties are expected values of microscopic properties,” where expected values account for the probabilities of different microstates. In Section 2.2, we derived the probability (density function) of finding a closed system in a particular microstate. In this section, we will combine these concepts to calculate macroscopic properties from expected values of microscopic properties, which we will refer to as <strong>ensemble averages</strong>.</p>
</section>
<section id="thermodynamic-equilibrium">
<h2>Thermodynamic Equilibrium<a class="headerlink" href="#thermodynamic-equilibrium" title="Link to this heading">#</a></h2>
<p>In Section 1.1, we defined <strong>thermodynamic equilibrium</strong> as “a state of simultaneous mechanical, thermal, and chemical equilibrium.” We will now define mechanical, thermal, and chemical equilibrium.</p>
<dl class="simple glossary">
<dt id="term-Thermal-contact">Thermal contact<a class="headerlink" href="#term-Thermal-contact" title="Link to this term">#</a></dt><dd><p>A state in which two systems in contact can exchange energy.</p>
</dd>
<dt id="term-Chemical-contact">Chemical contact<a class="headerlink" href="#term-Chemical-contact" title="Link to this term">#</a></dt><dd><p>A state in which two systems in contact can exchange matter.</p>
</dd>
<dt id="term-Mechanical-equilibrium">Mechanical equilibrium<a class="headerlink" href="#term-Mechanical-equilibrium" title="Link to this term">#</a></dt><dd><p>A state in which the net force on all particles in a system is zero.</p>
</dd>
<dt id="term-Thermal-equilibrium">Thermal equilibrium<a class="headerlink" href="#term-Thermal-equilibrium" title="Link to this term">#</a></dt><dd><p>A state in which the net exchange of energy between all systems in thermal contact is zero.</p>
</dd>
<dt id="term-Chemical-equilibrium">Chemical equilibrium<a class="headerlink" href="#term-Chemical-equilibrium" title="Link to this term">#</a></dt><dd><p>A state in which the net exchange of matter between all systems in chemical contact is zero.</p>
</dd>
</dl>
</section>
<section id="internal-energy">
<h2>Internal Energy<a class="headerlink" href="#internal-energy" title="Link to this heading">#</a></h2>
<p>The internal energy <span class="math notranslate nohighlight">\(U\)</span> of a macroscopic system in thermodynamic equilibrium is defined as the ensemble average <span class="math notranslate nohighlight">\(\langle \cdot \rangle\)</span> of the total energy <span class="math notranslate nohighlight">\(E\)</span> of the system.</p>
<div class="math notranslate nohighlight">
\[U \overset{\text{def}}{=} \langle E \rangle = \sum_{i = 1}^M E_i p_i\]</div>
<p>where <span class="math notranslate nohighlight">\(E_i\)</span> is the energy of microstate <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(p_i\)</span> is the probability of finding the system in microstate <span class="math notranslate nohighlight">\(i\)</span>. Substituting the probability (density function) for the canonical ensemble (i.e., the canonical distribution) from Section 2.2, we get</p>
<div class="math notranslate nohighlight" id="equation-eq-ensemble-average-internal-energy-sum">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-ensemble-average-internal-energy-sum" title="Link to this equation">#</a></span>\[U = \sum_{i = 1}^M E_i \frac{e^{-\beta E_i}}{Q} = \frac{1}{Q} \sum_{i = 1}^M E_i e^{-\beta E_i}\]</div>
<p>where <span class="math notranslate nohighlight">\(Q\)</span> is the partition function for the canonical ensemble (i.e., the canonical partition function) from Section 2.2.</p>
<div class="dropdown admonition">
<p class="admonition-title">Why can we factor out the partition function?</p>
<p>Since the partition function is defined at constant number of particles, volume, and temperature, it does not depend on the (microstate) index of summation. Therefore, the partition function is a constant and can be factored out of the sum.</p>
</div>
<section id="partial-derivative-of-the-partition-function-with-respect-to-beta">
<h3>Partial Derivative of the Partition Function with Respect to <span class="math notranslate nohighlight">\(\beta\)</span><a class="headerlink" href="#partial-derivative-of-the-partition-function-with-respect-to-beta" title="Link to this heading">#</a></h3>
<p>If we take the partial derivative of the partition function with respect to <span class="math notranslate nohighlight">\(\beta\)</span>, we get an interesting result.</p>
<div class="math notranslate nohighlight">
\[\left( \frac{\partial Q}{\partial \beta} \right)_{N, V} = \left( \frac{\partial}{\partial \beta} \sum_{i = 1}^M e^{-\beta E_i} \right)_{N, V} = \sum_{i = 1}^M \left( \frac{\partial}{\partial \beta} e^{-\beta E_i} \right)_{N, V} = -\sum_{i = 1}^M E_i e^{-\beta E_i}\]</div>
<p>Substituting this result into Equation <a class="reference internal" href="#equation-eq-ensemble-average-internal-energy-sum">(14)</a>, we get</p>
<div class="math notranslate nohighlight" id="equation-eq-ensemble-average-internal-energy">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-ensemble-average-internal-energy" title="Link to this equation">#</a></span>\[U = - \frac{1}{Q} \left( \frac{\partial Q}{\partial \beta} \right)_{N, V} = -\left( \frac{\partial \ln Q}{\partial \beta} \right)_{N, V}\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Where did the natural logarithm come from?</p>
<p>Applying the chain rule to the partial derivative of the natural logarithm of the partition function with respect to <span class="math notranslate nohighlight">\(\beta\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\left( \frac{\partial \ln Q}{\partial \beta} \right)_{N, V} = \left( \frac{\partial \ln Q}{\partial Q} \frac{\partial Q}{\partial \beta} \right)_{N, V} = \frac{1}{Q} \left( \frac{\partial Q}{\partial \beta} \right)_{N, V}\]</div>
</div>
</section>
<section id="internal-energy-of-a-two-state-system">
<h3>Internal Energy of a Two-State System<a class="headerlink" href="#internal-energy-of-a-two-state-system" title="Link to this heading">#</a></h3>
<p>In Section 2.2, we derived the canonical partition function for a two-state system as</p>
<div class="math notranslate nohighlight">
\[Q_{\text{two-state}} = e^{-\beta E_1} + e^{-\beta E_2}\]</div>
<p>Substituting this result into Equation <a class="reference internal" href="#equation-eq-ensemble-average-internal-energy">(15)</a>, we get</p>
<div class="math notranslate nohighlight">
\[U_{\text{two-state}} = -\left( \frac{\partial \ln Q_{\text{two-state}}}{\partial \beta} \right)_{N, V} = -\left[ \frac{\partial}{\partial \beta} \ln \left( e^{-\beta E_1} + e^{-\beta E_2} \right) \right]_{N, V}\]</div>
<p>Applying the chain rule to the partial derivative, we get</p>
<div class="math notranslate nohighlight">
\[U_{\text{two-state}} = \frac{E_1 e^{-\beta E_1} + E_2 e^{-\beta E_2}}{e^{-\beta E_1} + e^{-\beta E_2}}\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Consistency Check</p>
<p>Since the denominator is <span class="math notranslate nohighlight">\(Q_{\text{two-state}}\)</span>, we can write <span class="math notranslate nohighlight">\(U_{\text{two-state}}\)</span> as</p>
<div class="math notranslate nohighlight">
\[U_{\text{two-state}} = \frac{E_1 e^{-\beta E_1} + E_2 e^{-\beta E_2}}{Q_{\text{two-state}}}\]</div>
<p>Applying the definition of the canonical distribution, we get</p>
<div class="math notranslate nohighlight">
\[U_{\text{two-state}} = E_1 p_1 + E_2 p_2 = \sum_{i = 1}^2 E_i p_i = \langle E \rangle,\]</div>
<p>which demonstrates that Equation <a class="reference internal" href="#equation-eq-ensemble-average-internal-energy">(15)</a> is consistent with the definition of an ensemble average.</p>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">k</span><span class="p">,</span> <span class="n">eV</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.differentiate</span><span class="w"> </span><span class="kn">import</span> <span class="n">derivative</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span>

<span class="n">k_B</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="n">eV</span>  <span class="c1"># Boltzmann constant in eV/K</span>

<span class="c1"># Define the partition function for a two-state system</span>
<span class="k">def</span><span class="w"> </span><span class="nf">partition_function_two_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E2</span><span class="p">)</span>

<span class="c1"># Calculate the partition function for a two-state system</span>
<span class="n">E1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">E2</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># Energy difference between the two states in eV</span>
<span class="n">T_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">Q_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">partition_function_two_state</span><span class="p">(</span><span class="n">E1</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_values</span><span class="p">]</span>

<span class="c1"># Calculate the internal energy for a two-state system</span>
<span class="n">beta_values</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T_values</span><span class="p">)</span>
<span class="n">ln_Q_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Q_values</span><span class="p">)</span>
<span class="n">U_values</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">ln_Q_values</span><span class="p">,</span> <span class="n">beta_values</span><span class="p">)</span>

<span class="c1"># Plot the internal energy as a function of temperature</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_values</span><span class="p">,</span> <span class="n">U_values</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$U_{</span><span class="se">\\</span><span class="s1">text{two-state}} - E_1$ (eV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
    <span class="s1">&#39;$U_{</span><span class="se">\\</span><span class="s1">text{two-state}} </span><span class="se">\\</span><span class="s1">rightarrow E_1$&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">U_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span>
    <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.3&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">),</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
<span class="p">)</span>
<span class="n">x_values_high_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">y_values_high_T</span> <span class="o">=</span> <span class="p">((</span><span class="n">E1</span> <span class="o">+</span> <span class="n">E2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_values_high_T</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values_high_T</span><span class="p">,</span> <span class="n">y_values_high_T</span><span class="p">,</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$U_{</span><span class="se">\\</span><span class="s1">text{two-state}} </span><span class="se">\\</span><span class="s1">rightarrow (E_1 + E_2) / 2$&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;fig:ensemble-average-internal-energy-two-state&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="id1" style="width: 100%">
<img alt="../_images/29b37f89554bf093ba64447c8567f10f2fcb58168ac789bcb3ae642c4f86fdd8.png" src="../_images/29b37f89554bf093ba64447c8567f10f2fcb58168ac789bcb3ae642c4f86fdd8.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Internal energy of a two-state system as a function of temperature. The energy difference between the two states is 0.01 eV.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="heat-capacity-at-constant-volume">
<h2>Heat Capacity at Constant Volume<a class="headerlink" href="#heat-capacity-at-constant-volume" title="Link to this heading">#</a></h2>
<p>The heat capacity at constant volume <span class="math notranslate nohighlight">\(C_V\)</span> (to be discussed in Module 3) is defined as the partial derivative of the internal energy <span class="math notranslate nohighlight">\(U\)</span> with respect to temperature <span class="math notranslate nohighlight">\(T\)</span> at constant number of particles <span class="math notranslate nohighlight">\(N\)</span> and volume <span class="math notranslate nohighlight">\(V\)</span>.</p>
<div class="dropdown admonition">
<p class="admonition-title">What Does Heat Capacity Describe?</p>
<p>In Section 1.1, heat was defined as “energy transferred because of a temperature difference.” Heat capacity describes the amount of heat required to change the temperature of a system.</p>
</div>
<div class="math notranslate nohighlight">
\[C_V \overset{\text{def}}{=} \left( \frac{\partial U}{\partial T} \right)_{N, V}\]</div>
<p>Substituting Equation <a class="reference internal" href="#equation-eq-ensemble-average-internal-energy">(15)</a>, we get</p>
<div class="math notranslate nohighlight">
\[C_V = -\left( \frac{\partial^2 \ln Q}{\partial \beta^2} \right)_{N, V}\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter-02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="section-02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2.2. Canonical Ensemble</p>
      </div>
    </a>
    <a class="right-next"
       href="../appendices/appendix-a.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Appendix A. Differential Calculus</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-equilibrium">Thermodynamic Equilibrium</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-energy">Internal Energy</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-derivative-of-the-partition-function-with-respect-to-beta">Partial Derivative of the Partition Function with Respect to <span class="math notranslate nohighlight">\(\beta\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#internal-energy-of-a-two-state-system">Internal Energy of a Two-State System</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heat-capacity-at-constant-volume">Heat Capacity at Constant Volume</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert B. Wexler
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>