
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1.4. Real Gases &#8212; Physical Chemistry II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=536cf54f" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter-01/section-04';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Review" href="review.html" />
    <link rel="prev" title="1.3. Ideal Gases" href="section-03.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Physical Chemistry II - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="Physical Chemistry II - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Physical Chemistry II
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 1. Equations of State</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="section-01.html">1.1. Course Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-02.html">1.2. Kinetic Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="section-03.html">1.3. Ideal Gases</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1.4. Real Gases</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Module 2. Statistical Mechanics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/section-01.html">2.1. Introduction to Statistical Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/section-02.html">2.2. Canonical Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/section-03.html">2.3. Ensemble Averages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/section-04.html">2.4. Molecular Partition Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/section-05.html">2.5. Particle in a Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter-02/review.html">Review</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendices/appendix-a.html">Appendix A. Differential Calculus</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter-01/section-04.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapter-01/section-04.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>1.4. Real Gases</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deviations-from-ideal-behavior">Deviations from Ideal Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compressibility-factor">Compressibility Factor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-fluid">Van der Waals Fluid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-equation-of-state">Van der Waals Equation of State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-isotherm">Van der Waals Isotherm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-point">Critical Point</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#corresponding-states">Corresponding States</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="real-gases">
<h1>1.4. Real Gases<a class="headerlink" href="#real-gases" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>Under high pressures, high densities, or low temperatures, we cannot treat gases as sets of non-interacting point particles. Higher pressures imply more frequent collisions and higher densities, higher densities are associated with closer molecules that can more strongly interact and experience each other’s finite size, and lower temperatures indicate that molecules have lower kinetic energy and are more disposed to be affected by these interactions. This section presents approaches for quantifying deviations from ideal behavior and the van der Waals equation of state, which is one of the simplest models for real gases and the subject of the <a class="reference external" href="https://www.nobelprize.org/prizes/physics/1910/summary/">Nobel Prize in Physics 1910</a>.</p>
</section>
<section id="deviations-from-ideal-behavior">
<h2>Deviations from Ideal Behavior<a class="headerlink" href="#deviations-from-ideal-behavior" title="Link to this heading">#</a></h2>
<section id="compressibility-factor">
<h3>Compressibility Factor<a class="headerlink" href="#compressibility-factor" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.interpolate</span><span class="w"> </span><span class="kn">import</span> <span class="n">interp1d</span>

<span class="c1"># Load the experimental data for water at 300 K</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../_static/section-04/isothermal-properties-for-water-T=300.csv&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;rho_m&quot;</span><span class="p">,</span> <span class="s2">&quot;V_m&quot;</span><span class="p">]</span>  <span class="c1"># Rename columns</span>

<span class="c1"># Calculate the compressibility factor</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;P_Pa&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e5</span>  <span class="c1"># Convert pressure from bar to Pa</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P_Pa&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;V_m&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>

<span class="c1"># Set up figure and axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$Z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Plot experimental compressibility factor</span>
<span class="n">data_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$Z_</span><span class="se">\\</span><span class="s2">text</span><span class="si">{water}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">data_line</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Plot ideal gas line</span>
<span class="n">x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ideal_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_values</span><span class="p">),</span> <span class="s2">&quot;r--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$Z_</span><span class="se">\\</span><span class="s2">text</span><span class="si">{ideal}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">ideal_line</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="p">[</span><span class="mi">400</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Interpolate to find intersection with ideal gas line</span>
<span class="n">interp_Z</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)</span>
<span class="n">intersection_pressure</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">intersection_Z</span> <span class="o">=</span> <span class="n">interp_Z</span><span class="p">(</span><span class="n">intersection_pressure</span><span class="p">)</span>

<span class="c1"># Find pressure and Z value at minimum Z</span>
<span class="n">min_Z_index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
<span class="n">min_pressure</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_Z_index</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">]</span>
<span class="n">min_Z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">min_Z_index</span><span class="p">,</span> <span class="s2">&quot;Z&quot;</span><span class="p">]</span>

<span class="c1"># Annotate ideal and coincidentally ideal points</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Ideal&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Coincidentally</span><span class="se">\n</span><span class="s2">ideal&quot;</span><span class="p">,</span>
            <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Draw vertical lines for reference</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="c1"># Highlight regions of attractive and repulsive behavior</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">intersection_pressure</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;magenta&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Attractive&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">([</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Repulsive&quot;</span><span class="p">)</span>

<span class="c1"># Annotate regions</span>
<span class="n">x_values_for_attractive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">intersection_pressure</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">attractive_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values_for_attractive</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_values_for_attractive</span><span class="p">)</span> <span class="o">*</span> <span class="n">min_Z</span><span class="p">,</span> <span class="s2">&quot;m-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Attractive&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">attractive_line</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">min_pressure</span><span class="p">,</span> <span class="n">intersection_pressure</span><span class="p">]),</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">x_values_for_repulsive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">intersection_pressure</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">repulsive_line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_values_for_repulsive</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_values_for_repulsive</span><span class="p">)</span> <span class="o">*</span> <span class="n">min_Z</span><span class="p">,</span> <span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Repulsive&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">repulsive_line</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Adjust layout and display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;compressibility-factor&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="id1" style="width: 100%">
<img alt="../_images/7aebf82d9a32ecc1f1cbbef88916a102d99d018513673c556aeafd972681f553.png" src="../_images/7aebf82d9a32ecc1f1cbbef88916a102d99d018513673c556aeafd972681f553.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Compressibility factor <span class="math notranslate nohighlight">\(Z\)</span> of water at 300 K as a function of pressure, with the ideal-gas line (<span class="math notranslate nohighlight">\(Z=1\)</span>) included for comparison. The dip below <span class="math notranslate nohighlight">\(Z=1\)</span> highlights net attractive forces (most pronounced at the minimum <span class="math notranslate nohighlight">\(Z\)</span>), while crossing above <span class="math notranslate nohighlight">\(Z=1\)</span> at higher pressures reflects repulsive interactions. The point at which the real-gas curve intersects the ideal-gas line indicates a coincidental match to ideal behavior.</span><a class="headerlink" href="#id1" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>One of the ways to quantify deviations from ideal behavior is by way of the compressibility factor <span class="math notranslate nohighlight">\(Z\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-compressibility-factor">
<span class="eqno">(7)<a class="headerlink" href="#equation-compressibility-factor" title="Link to this equation">#</a></span>\[Z = \frac{P V}{N k_\text{B} T} = \frac{P V}{n R T}.\]</div>
<div class="pst-scrollable-table-container"><table class="table" id="water-compressibility-analysis">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Behavior of Water at Different Pressures</span><a class="headerlink" href="#water-compressibility-analysis" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Pressure</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(Z\)</span></p></th>
<th class="head"><p>Volume</p></th>
<th class="head"><p>Analysis</p></th>
<th class="head"><p>Water</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>High</p></td>
<td><p><span class="math notranslate nohighlight">\(&gt; 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(V_\text{real} &gt; V_\text{ideal}\)</span></p></td>
<td><p>Repulsive interactions</p></td>
<td><p>Pauli repulsion (steric hindrance)</p></td>
</tr>
<tr class="row-odd"><td><p>Medium</p></td>
<td><p><span class="math notranslate nohighlight">\(&lt; 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(V_\text{real} &lt; V_\text{ideal}\)</span></p></td>
<td><p>Attractive interactions</p></td>
<td><p>H bonding and van der Waals interactions</p></td>
</tr>
<tr class="row-even"><td><p>Low</p></td>
<td><p><span class="math notranslate nohighlight">\(= 1\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(V_\text{real} = V_\text{ideal}\)</span></p></td>
<td><p>Ideal gas behavior</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Can you demonstrate why <span class="math notranslate nohighlight">\(V_\text{real} &gt; V_\text{ideal}\)</span> for <span class="math notranslate nohighlight">\(Z &gt; 1\)</span> and <span class="math notranslate nohighlight">\(V_\text{real} &lt; V_\text{ideal}\)</span> for <span class="math notranslate nohighlight">\(Z &lt; 1\)</span>?</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>What might be the cause of attractive interactions in a gas of carbon dioxide or methane molecules?</p>
</div>
</section>
</section>
<section id="van-der-waals-fluid">
<h2>Van der Waals Fluid<a class="headerlink" href="#van-der-waals-fluid" title="Link to this heading">#</a></h2>
<section id="van-der-waals-equation-of-state">
<h3>Van der Waals Equation of State<a class="headerlink" href="#van-der-waals-equation-of-state" title="Link to this heading">#</a></h3>
<p>The van der Waals equation of state is one of the simplest models for real gases and the subject of the <a class="reference external" href="https://www.nobelprize.org/prizes/physics/1910/summary/">Nobel Prize in Physics 1910</a>:</p>
<div class="pst-scrollable-table-container"><table class="table" id="van-der-waals-forms">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Forms of the van der Waals Equation of State</span><a class="headerlink" href="#van-der-waals-forms" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>Extensive Volume</p></th>
<th class="head"><p>Intensive Volume</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Per Particle</p></td>
<td><div class="math notranslate nohighlight">
\[\left( P + \frac{a_\text{p} N^2}{V^2} \right) \left( V - b_\text{p} N \right) = N k_\text{B} T\]</div>
</td>
<td><div class="math notranslate nohighlight">
\[\left( P + \frac{a_\text{p}}{V_\text{p}^2} \right) \left( V_\text{p} - b_\text{p} \right) = k_\text{B} T\]</div>
</td>
</tr>
<tr class="row-odd"><td><p>Per Mole</p></td>
<td><div class="math notranslate nohighlight">
\[\left( P + \frac{a_\text{m} n^2}{V^2} \right) \left( V - b_\text{m} n \right) = n R T\]</div>
</td>
<td><div class="math notranslate nohighlight" id="equation-van-der-waals-eos">
<span class="eqno">(8)<a class="headerlink" href="#equation-van-der-waals-eos" title="Link to this equation">#</a></span>\[\left( P + \frac{a_\text{m}}{V_\text{m}^2} \right) \left( V_\text{m} - b_\text{m} \right) = R T,\]</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are constants that quantify two deviations from ideal behavior:</p>
<ul class="simple">
<li><p><strong><span class="math notranslate nohighlight">\(a\)</span></strong>: Attractive interactions between particles.</p></li>
<li><p><strong><span class="math notranslate nohighlight">\(b\)</span></strong>: Volume occupied by the particles.</p></li>
</ul>
</section>
<section id="van-der-waals-isotherm">
<h3>Van der Waals Isotherm<a class="headerlink" href="#van-der-waals-isotherm" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># van der Waals constants for carbon dioxide</span>
<span class="n">a_m_L_bar</span> <span class="o">=</span> <span class="mf">3.6551</span>  <span class="c1"># L^2 bar / mol^2</span>
<span class="n">b_m_L</span> <span class="o">=</span> <span class="mf">0.042816</span>  <span class="c1"># L / mol</span>
<span class="n">L_to_m3</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># m^3 / L</span>
<span class="n">bar_to_Pa</span> <span class="o">=</span> <span class="mf">1e5</span>  <span class="c1"># Pa / bar</span>
<span class="n">a_m</span> <span class="o">=</span> <span class="n">a_m_L_bar</span> <span class="o">*</span> <span class="n">L_to_m3</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">bar_to_Pa</span>  <span class="c1"># m^6 Pa / mol^2</span>
<span class="n">b_m</span> <span class="o">=</span> <span class="n">b_m_L</span> <span class="o">*</span> <span class="n">L_to_m3</span>  <span class="c1"># m^3 / mol</span>

<span class="c1"># van der Waals critical properties for carbon dioxide</span>
<span class="n">Tc_vdW</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a_m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_m</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># K</span>
<span class="n">Pc_vdW</span> <span class="o">=</span> <span class="n">a_m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Pa</span>
<span class="n">Vc_vdW</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b_m</span>  <span class="c1"># m^3 / mol</span>

<span class="c1"># Experimental phase change data for carbon dioxide</span>
<span class="n">Tc_exp</span> <span class="o">=</span> <span class="mf">304.18</span>  <span class="c1"># K</span>
<span class="n">Pc_exp</span> <span class="o">=</span> <span class="mf">73.80</span> <span class="o">*</span> <span class="n">bar_to_Pa</span>  <span class="c1"># Pa</span>
<span class="n">Vc_exp</span> <span class="o">=</span> <span class="mf">0.0919</span> <span class="o">*</span> <span class="n">L_to_m3</span>  <span class="c1"># m^3 / mol</span>

<span class="c1"># van der Waals pressure function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">van_der_waals_pressure</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">R</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span> <span class="o">/</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># Load experimental data</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_experimental_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Tc&quot;</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="s2">&quot;rho_m&quot;</span><span class="p">,</span> <span class="s2">&quot;V_m&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">df_lt_Tc</span> <span class="o">=</span> <span class="n">load_experimental_data</span><span class="p">(</span><span class="s2">&quot;../_static/section-04/isothermal-properties-for-carbon-dioxide-Tr=0.9.csv&quot;</span><span class="p">)</span>
<span class="n">df_at_Tc</span> <span class="o">=</span> <span class="n">load_experimental_data</span><span class="p">(</span><span class="s2">&quot;../_static/section-04/isothermal-properties-for-carbon-dioxide-Tr=1.0.csv&quot;</span><span class="p">)</span>
<span class="n">df_gt_Tc</span> <span class="o">=</span> <span class="n">load_experimental_data</span><span class="p">(</span><span class="s2">&quot;../_static/section-04/isothermal-properties-for-carbon-dioxide-Tr=1.1.csv&quot;</span><span class="p">)</span>

<span class="c1"># Set up figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">Vm_vdW</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Plot van der Waals isotherms</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">]</span>
<span class="n">temps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span> <span class="o">*</span> <span class="n">Tc_vdW</span><span class="p">,</span> <span class="n">Tc_vdW</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">Tc_vdW</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;$T &lt; T_c$&quot;</span><span class="p">,</span> <span class="s2">&quot;$T = T_c$&quot;</span><span class="p">,</span> <span class="s2">&quot;$T &gt; T_c$&quot;</span><span class="p">]</span>
<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">P_vdW</span> <span class="o">=</span> <span class="n">van_der_waals_pressure</span><span class="p">(</span><span class="n">a_m</span><span class="p">,</span> <span class="n">b_m</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Vm_vdW</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vdW</span> <span class="o">/</span> <span class="n">L_to_m3</span><span class="p">,</span> <span class="n">P_vdW</span> <span class="o">/</span> <span class="n">bar_to_Pa</span><span class="p">,</span> <span class="n">color</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">labelLines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Plot experimental isotherms</span>
<span class="k">for</span> <span class="n">df</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">df_lt_Tc</span><span class="p">,</span> <span class="n">df_at_Tc</span><span class="p">,</span> <span class="n">df_gt_Tc</span><span class="p">],</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;V_m&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">L_to_m3</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">],</span> <span class="n">color</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Legend and labels</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;van der Waals&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">),</span>
                   <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experimental&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Molar Volume (L/mol)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Adjust layout and display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;van-der-waals-isotherms&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="van-der-waals-isotherms" style="width: 100%">
<img alt="../_images/d972d2a4c525acf0a514069da4c1b12f9a26c659f4c4e4963664a3db81e5a434.png" src="../_images/d972d2a4c525acf0a514069da4c1b12f9a26c659f4c4e4963664a3db81e5a434.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Comparison of experimental and van der Waals isotherms for CO<sub>2</sub> at temperatures below, at, and above the critical temperature <span class="math notranslate nohighlight">\(T_c\)</span>. The subcritical isotherm (<span class="math notranslate nohighlight">\(T &lt; T_c\)</span>) displays the characteristic loop associated with phase separation, while the isotherm at <span class="math notranslate nohighlight">\(T = T_c\)</span> shows an inflection point, and supercritical conditions (<span class="math notranslate nohighlight">\(T &gt; T_c\)</span>) no longer exhibit a liquid–vapor transition.</span><a class="headerlink" href="#van-der-waals-isotherms" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="critical-point">
<h4>Critical Point<a class="headerlink" href="#critical-point" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reference: https://scipython.com/blog/the-maxwell-construction/</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span> <span class="k">as</span> <span class="n">R_SI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">quad</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">curve_fit</span><span class="p">,</span> <span class="n">newton</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">argrelextrema</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="n">R</span> <span class="o">=</span> <span class="n">R_SI</span> <span class="o">/</span> <span class="mi">100</span>  <span class="c1"># Gas constant in L bar / mol K</span>

<span class="c1"># van der Waals constants for carbon dioxide</span>
<span class="n">a_m</span> <span class="o">=</span> <span class="mf">3.6551</span>    <span class="c1"># L^2 bar/mol^2</span>
<span class="n">b_m</span> <span class="o">=</span> <span class="mf">0.042816</span>  <span class="c1"># L/mol</span>

<span class="c1"># van der Waals critical properties for carbon dioxide</span>
<span class="n">Tc_vdW</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">a_m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_m</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>  <span class="c1"># K</span>
<span class="n">Pc_vdW</span> <span class="o">=</span> <span class="n">a_m</span> <span class="o">/</span> <span class="p">(</span><span class="mi">27</span> <span class="o">*</span> <span class="n">b_m</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>       <span class="c1"># bar</span>
<span class="n">Vc_vdW</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">b_m</span>                   <span class="c1"># L/mol</span>

<span class="c1"># Reduced-pressure form of the van der Waals equation of state</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vdw</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Vr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Van der Waals equation of state.</span>

<span class="sd">    Return the reduced pressure from the reduced temperature and volume.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pr</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">Tr</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">Vr</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span><span class="o">/</span><span class="n">Vr</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">pr</span>

<span class="c1"># Maxwell construction of the reduced-pressure form of the van der Waals equation of state</span>
<span class="k">def</span><span class="w"> </span><span class="nf">vdw_maxwell</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Vr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Van der Waals equation of state with Maxwell construction.</span>

<span class="sd">    Return the reduced pressure from the reduced temperature and volume,</span>
<span class="sd">    applying the Maxwell construction correction to the unphysical region</span>
<span class="sd">    if necessary.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">pr</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Vr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">Tr</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># No unphysical region above the critical temperature.</span>
        <span class="k">return</span> <span class="n">pr</span>

    <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Negative pressure results from van der Waals&#39;</span>
                         <span class="s1">&#39; equation of state with Tr = </span><span class="si">{}</span><span class="s1"> K.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Tr</span><span class="p">))</span>

    <span class="c1"># Initial guess for the position of the Maxwell construction line:</span>
    <span class="c1"># the volume corresponding to the mean pressure between the minimum and</span>
    <span class="c1"># maximum in reduced pressure, pr.</span>
    <span class="n">iprmin</span> <span class="o">=</span> <span class="n">argrelextrema</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">)</span>
    <span class="n">iprmax</span> <span class="o">=</span> <span class="n">argrelextrema</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">greater</span><span class="p">)</span>
    <span class="n">Vr0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">Vr</span><span class="p">[</span><span class="n">iprmin</span><span class="p">],</span> <span class="n">Vr</span><span class="p">[</span><span class="n">iprmax</span><span class="p">]])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_Vlims</span><span class="p">(</span><span class="n">pr0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Solve the inverted van der Waals equation for reduced volume.</span>

<span class="sd">        Return the lowest and highest reduced volumes such that the reduced</span>
<span class="sd">        pressure is pr0. It only makes sense to call this function for</span>
<span class="sd">        T&lt;Tc, ie below the critical temperature where there are three roots.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pr0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">pr0</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">Tr</span><span class="p">),</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">roots</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">r</span>
        <span class="n">roots</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">Vrmin</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Vrmax</span> <span class="o">=</span> <span class="n">roots</span>
        <span class="k">return</span> <span class="n">Vrmin</span><span class="p">,</span> <span class="n">Vrmax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_area_difference</span><span class="p">(</span><span class="n">Vr0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the difference in areas of the van der Waals loops.</span>

<span class="sd">        Return the difference between the areas of the loops from Vr0 to Vrmax</span>
<span class="sd">        and from Vrmin to Vr0 where the reduced pressure from the van der Waals</span>
<span class="sd">        equation is the same at Vrmin, Vr0 and Vrmax. This difference is zero</span>
<span class="sd">        when the straight line joining Vrmin and Vrmax at pr0 is the Maxwell</span>
<span class="sd">        construction.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">pr0</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Vr0</span><span class="p">)</span>
        <span class="n">Vrmin</span><span class="p">,</span> <span class="n">Vrmax</span> <span class="o">=</span> <span class="n">get_Vlims</span><span class="p">(</span><span class="n">pr0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">quad</span><span class="p">(</span><span class="k">lambda</span> <span class="n">vr</span><span class="p">:</span> <span class="n">vdw</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">vr</span><span class="p">)</span> <span class="o">-</span> <span class="n">pr0</span><span class="p">,</span> <span class="n">Vrmin</span><span class="p">,</span> <span class="n">Vrmax</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Root finding by Newton&#39;s method determines Vr0 corresponding to</span>
    <span class="c1"># equal loop areas for the Maxwell construction.</span>
    <span class="n">Vr0</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">get_area_difference</span><span class="p">,</span> <span class="n">Vr0</span><span class="p">)</span>
    <span class="n">pr0</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">(</span><span class="n">Tr</span><span class="p">,</span> <span class="n">Vr0</span><span class="p">)</span>
    <span class="n">Vrmin</span><span class="p">,</span> <span class="n">Vrmax</span> <span class="o">=</span> <span class="n">get_Vlims</span><span class="p">(</span><span class="n">pr0</span><span class="p">)</span>

    <span class="c1"># Set the pressure in the Maxwell construction region to constant pr0.</span>
    <span class="n">pr</span><span class="p">[(</span><span class="n">Vr</span> <span class="o">&gt;=</span> <span class="n">Vrmin</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">Vr</span> <span class="o">&lt;=</span> <span class="n">Vrmax</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pr0</span>
    <span class="k">return</span> <span class="n">pr</span><span class="p">,</span> <span class="n">Vrmin</span><span class="p">,</span> <span class="n">Vrmax</span>

<span class="c1"># Reduced volume range</span>
<span class="n">Vr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plot the van der Waals isotherm below the critical temperature</span>
<span class="n">line1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vr</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">vdw</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Vr</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                    <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T = 0.9 T_c$&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">Pr_max</span><span class="p">,</span> <span class="n">Vr_liq</span><span class="p">,</span> <span class="n">Vr_vap</span> <span class="o">=</span> <span class="n">vdw_maxwell</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Vr</span><span class="p">)</span>
<span class="n">Pr_equ</span> <span class="o">=</span> <span class="n">Pr_max</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Pr_max</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span>
<span class="n">Vr_int</span> <span class="o">=</span> <span class="mf">0.140076</span> <span class="o">/</span> <span class="n">Vc_vdW</span>  <span class="c1"># https://www.wolframalpha.com/input?i=V%5E3-%28b%2BR*T%2FP%29*V%5E2%2Ba%2FP*V-a*b%2FP%3D0+for+a%3D3.6551%2C+b%3D0.042816%2C+R%3D8.314462618%2F100%2C+T%3D0.9*8*a%2F%2827*b*R%29%2C+P%3D0.64699835*a%2F%2827*b%5E2%29</span>
<span class="c1"># print(f&quot;At Tr = 0.90, the molar volume of the liquid phase is {Vr_liq * Vc_vdW:.4f} L/mol, the molar volume of the vapor phase is {Vr_vap * Vc_vdW:.4f} L/mol, and the equilibrium pressure is {Pr_equ * Pc_vdW:.4f} bar.&quot;)</span>

<span class="c1"># Calculate the molar volume of the liquid and vapor phases at Tr = 0.85</span>
<span class="n">Pr_max_85</span><span class="p">,</span> <span class="n">Vr_liq_85</span><span class="p">,</span> <span class="n">Vr_vap_85</span> <span class="o">=</span> <span class="n">vdw_maxwell</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">Vr</span><span class="p">)</span>
<span class="n">Pr_equ_85</span> <span class="o">=</span> <span class="n">Pr_max_85</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">Pr_max_85</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span>
<span class="c1"># print(f&quot;At Tr = 0.85, the molar volume of the liquid phase is {Vr_liq_85 * Vc_vdW:.4f} L/mol, the molar volume of the vapor phase is {Vr_vap_85 * Vc_vdW:.4f} L/mol, and the equilibrium pressure is {Pr_equ_85 * Pc_vdW:.4f} bar.&quot;)</span>

<span class="c1"># Calculate the molar volume of the liquid and vapor phases at Tr = 0.8</span>

<span class="c1"># Plot the van der Waals isotherm at the critical temperature</span>
<span class="n">line2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vr</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">vdw</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">Vr</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                    <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T = T_c$&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line2</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Fill the Maxwell construction region</span>
<span class="n">Vr_vals_fill_l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Vr_liq</span><span class="p">,</span> <span class="n">Vr_int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># Range of volumes for filling</span>
<span class="n">Pr_vals_fill_l</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Vr_vals_fill_l</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span>  <span class="c1"># Calculate pressures along the curve</span>
<span class="n">Vr_vals_fill_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Vr_int</span><span class="p">,</span> <span class="n">Vr_vap</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>   <span class="c1"># Range of volumes for filling</span>
<span class="n">Pr_vals_fill_r</span> <span class="o">=</span> <span class="n">vdw</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">Vr_vals_fill_r</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span>  <span class="c1"># Calculate pressures along the curve</span>

<span class="c1"># Fill the area between the vdw curve and the phase transition pressure Pr_equ</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">Vr_vals_fill_l</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>                         <span class="c1"># Scaled volume</span>
    <span class="n">Pr_vals_fill_l</span><span class="p">,</span>                                  <span class="c1"># Pressure from vdw curve</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vr_vals_fill_l</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>  <span class="c1"># Constant transition pressure</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>                                    <span class="c1"># Styling for the fill</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">Vr_vals_fill_r</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>                         <span class="c1"># Scaled volume</span>
    <span class="n">Pr_vals_fill_r</span><span class="p">,</span>                                  <span class="c1"># Pressure from vdw curve</span>
    <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vr_vals_fill_r</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>  <span class="c1"># Constant transition pressure</span>
    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>                                    <span class="c1"># Styling for the fill</span>
<span class="p">)</span>

<span class="c1"># Plot the molar volume of the liquid and vapor phases at Tr = 0.9</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vr_liq</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span> <span class="s1">&#39;wo&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vr_vap</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span> <span class="s1">&#39;wo&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="c1"># Annotate the Maxwell construction</span>
<span class="n">x_maxwell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">Vc_vdW</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Maxwell</span><span class="se">\n</span><span class="s2">construction&quot;</span><span class="p">,</span>
                <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_maxwell</span><span class="p">,</span> <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">),</span>
                <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_maxwell</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span>
                <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Plot and annotate the critical point</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">Pc_vdW</span><span class="p">,</span> <span class="s1">&#39;wo&#39;</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="n">Vm_vals_Vc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_supercritical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">Pc_vdW</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="n">line3</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_supercritical</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$V_{</span><span class="se">\\</span><span class="s1">text</span><span class="si">{m}</span><span class="s1">,c}$&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line3</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">Vm_vals_Pc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">line4</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$P_c$&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line4</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mf">0.035</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">200</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">Pc_vdW</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># Approximate the coexistence curve with a function</span>

<span class="c1"># Define the functional form: A * ln(B * Vm) * exp(-C * Vm ** 0.25)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fit_function</span><span class="p">(</span><span class="n">Vm</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">B</span> <span class="o">*</span> <span class="n">Vm</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">C</span> <span class="o">*</span> <span class="n">Vm</span> <span class="o">**</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># Extract data points: (Vm_liq, P_eq), (Vc, Pc), (Vm_vap, P_eq)</span>
<span class="n">Vm_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Vr_liq</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">Vr_liq_85</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">Vr_vap_85</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">,</span>
                    <span class="n">Vr_vap</span> <span class="o">*</span> <span class="n">Vc_vdW</span><span class="p">])</span>
<span class="n">P_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                   <span class="n">Pr_equ_85</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                   <span class="n">Pc_vdW</span><span class="p">,</span>
                   <span class="n">Pr_equ_85</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                   <span class="n">Pr_equ</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">])</span>

<span class="c1"># Provide an initial guess for the parameters A, B, C</span>
<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Fit the curve to the data</span>
<span class="n">params</span><span class="p">,</span> <span class="n">covariance</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">fit_function</span><span class="p">,</span> <span class="n">Vm_data</span><span class="p">,</span> <span class="n">P_data</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>

<span class="c1"># Extract fitted parameters</span>
<span class="n">A_fit</span><span class="p">,</span> <span class="n">B_fit</span><span class="p">,</span> <span class="n">C_fit</span> <span class="o">=</span> <span class="n">params</span>
<span class="c1"># print(f&quot;Fitted parameters: A = {A_fit}, B = {B_fit}, C = {C_fit}&quot;)</span>

<span class="c1"># Generate data for plotting the fitted curve</span>
<span class="n">P_fit</span> <span class="o">=</span> <span class="n">fit_function</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">,</span> <span class="n">A_fit</span><span class="p">,</span> <span class="n">B_fit</span><span class="p">,</span> <span class="n">C_fit</span><span class="p">)</span>

<span class="c1"># Fitted curve</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">,</span> <span class="n">P_fit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">,</span> <span class="n">P_fit</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Annotate the coexistence curve</span>
<span class="n">line5</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Vc</span> <span class="o">-</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">P_fit</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Liquid&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line5</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&lt;=</span> <span class="n">Vc_vdW</span><span class="p">],</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&lt;=</span> <span class="n">Vc_vdW</span><span class="p">])</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                    <span class="n">P_fit</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&lt;=</span> <span class="n">Vc_vdW</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">line6</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Vc</span> <span class="o">+</span> <span class="mf">0.04</span><span class="p">,</span> <span class="n">P_fit</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vapor&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line6</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="mf">0.32</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&gt;=</span> <span class="n">Vc_vdW</span><span class="p">],</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Vc</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&gt;=</span> <span class="n">Vc_vdW</span><span class="p">])</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                    <span class="n">P_fit</span><span class="p">[</span><span class="n">Vm_vals_Vc</span> <span class="o">&gt;=</span> <span class="n">Vc_vdW</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">line7</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">)</span> <span class="o">*</span> <span class="n">y_supercritical</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Supercritical fluid&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line7</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="n">Vc_vdW</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">)</span> <span class="o">*</span> <span class="n">Pc_vdW</span><span class="p">,</span>
                    <span class="mi">80</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">line8</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">Vm_vals_Pc</span><span class="p">)</span> <span class="o">*</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Liquid-vapor</span><span class="se">\n</span><span class="s1">mixture&#39;</span><span class="p">)</span>
<span class="n">labelLines</span><span class="p">(</span><span class="n">line8</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="n">x_maxwell</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Molar Volume (L/mol)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Molar Volume (L/mol)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Adjust layout and display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;van-der-waals-critical-point&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="van-der-waals-critical-point" style="width: 100%">
<img alt="../_images/4c49a3bf3460daecf0701a1ce4e3ea68b0095741e6de7023045ba2cb0510a425.png" src="../_images/4c49a3bf3460daecf0701a1ce4e3ea68b0095741e6de7023045ba2cb0510a425.png" />
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Van der Waals isotherm for CO<sub>2</sub> at <span class="math notranslate nohighlight">\(T = 0.9\,T_c\)</span>, with the Maxwell construction illustrating how the unphysical loop is replaced by a horizontal tie line defining liquid–vapor coexistence. The critical point at <span class="math notranslate nohighlight">\(T = T_c\)</span> is also shown, where the liquid and vapor phases merge.</span><a class="headerlink" href="#van-der-waals-critical-point" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Expanding Equation <a class="reference internal" href="#equation-van-der-waals-eos">(8)</a> and rearranging terms:</p>
<div class="math notranslate nohighlight" id="equation-van-der-waals-eos-expanded">
<span class="eqno">(9)<a class="headerlink" href="#equation-van-der-waals-eos-expanded" title="Link to this equation">#</a></span>\[V_\text{m}^3 - \left( b_\text{m} + \frac{R T}{P} \right) V_\text{m}^2 + \frac{a_\text{m}}{P} V_\text{m} - \frac{a_\text{m} b_\text{m}}{P} = 0.\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Complete Derivation of the Cubic Equation in <span class="math notranslate nohighlight">\(V_\text{m}\)</span></p>
<p><strong>1. Expand Equation <a class="reference internal" href="#equation-van-der-waals-eos">(8)</a> and Subtract <span class="math notranslate nohighlight">\(RT\)</span> From Both Sides:</strong></p>
<div class="math notranslate nohighlight">
\[P V_\text{m} - P b_\text{m} + \frac{a_\text{m}}{V_\text{m}} - \frac{a_\text{m} b_\text{m}}{V_\text{m}^2} - R T = 0.\]</div>
<p><strong>2. Multiply Both Sides by <span class="math notranslate nohighlight">\(V_\text{m}^2 / P\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[V_\text{m}^3 - b_\text{m} V_\text{m}^2 + \frac{a_\text{m}}{P} V_\text{m} - \frac{a_\text{m} b_\text{m}}{P} - \frac{R T}{P} V_\text{m}^2 = 0.\]</div>
<p><strong>3. Group Terms:</strong></p>
<div class="math notranslate nohighlight">
\[V_\text{m}^3 - \left( b_\text{m} + \frac{R T}{P} \right) V_\text{m}^2 + \frac{a_\text{m}}{P} V_\text{m} - \frac{a_\text{m} b_\text{m}}{P} = 0.\]</div>
</div>
<p>At the critical point, Equation <a class="reference internal" href="#equation-van-der-waals-eos-expanded">(9)</a> simplifies to:</p>
<div class="math notranslate nohighlight">
\[\left( V_\text{m} - V_{\text{m},c} \right)^3 = V_\text{m}^3 - 3 V_{\text{m},c} V_\text{m}^2 + 3 V_{\text{m},c}^2 V_\text{m} - V_{\text{m},c}^3 = 0.\]</div>
<p>Comparing these equations:</p>
<div class="math notranslate nohighlight">
\[V_{\text{m},c} = 3 b_\text{m}, \quad P_{\text{c}} = \frac{a_\text{m}}{27 b_\text{m}^2}, \quad T_{\text{c}} = \frac{8 a_\text{m}}{27 b_\text{m} R}.\]</div>
<div class="dropdown admonition">
<p class="admonition-title">Complete Derivation of the Critical Point</p>
<p><strong>1. Set Coefficients Equal to Each Other and Solve for Powers of <span class="math notranslate nohighlight">\(V_{\text{m},c}\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[V_{\text{m},c} = \frac{1}{3} \left( b_\text{m} + \frac{R T_{\text{c}}}{P_{\text{c}}} \right), \quad V_{\text{m},c}^2 = \frac{a_\text{m}}{3 P_{\text{c}}}, \quad V_{\text{m},c}^3 = \frac{a_\text{m} b_\text{m}}{P_{\text{c}}}.\]</div>
<p><strong>2. Divide <span class="math notranslate nohighlight">\(V_{\text{m},c}^3\)</span> by <span class="math notranslate nohighlight">\(V_{\text{m},c}^2\)</span> and Eliminate <span class="math notranslate nohighlight">\(P_{\text{c}}\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\frac{V_{\text{m},c}^3}{V_{\text{m},c}^2} &amp;= \frac{a_\text{m} b_\text{m}}{P_{\text{c}}} \cdot \frac{3 P_{\text{c}}}{a_\text{m}} \\
V_{\text{m},c} &amp;= 3 b_\text{m}.
\end{aligned}\end{split}\]</div>
<p><strong>3. Substitute This Result Into <span class="math notranslate nohighlight">\(V_{\text{m},c}^3\)</span> and Solve for <span class="math notranslate nohighlight">\(P_{\text{c}}\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
V_{\text{m},c}^3 &amp;= \frac{a_\text{m} b_\text{m}}{P_{\text{c}}} \\
27 b_\text{m}^3 &amp;= \frac{a_\text{m} b_\text{m}}{P_{\text{c}}} \\
P_{\text{c}} &amp;= \frac{a_\text{m}}{27 b_\text{m}^2}.
\end{aligned}\end{split}\]</div>
<p><strong>4. Substitute These Results Into <span class="math notranslate nohighlight">\(V_{\text{m},c}\)</span> and Solve for <span class="math notranslate nohighlight">\(T_{\text{c}}\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
V_{\text{m},c} &amp;= \frac{1}{3} \left( b_\text{m} + \frac{R T_{\text{c}}}{P_{\text{c}}} \right) \\
3 b_\text{m} &amp;= \frac{1}{3} \left( b_\text{m} + R T_{\text{c}} \cdot \frac{27 b_\text{m}^2}{a_\text{m}} \right) \\
9 b_\text{m} &amp;= b_\text{m} + R T_{\text{c}} \cdot \frac{27 b_\text{m}^2}{a_\text{m}} \\
8 b_\text{m} &amp;= R T_{\text{c}} \cdot \frac{27 b_\text{m}^2}{a_\text{m}} \\
T_{\text{c}} &amp;= \frac{8 a_\text{m}}{27 b_\text{m} R}.
\end{aligned}\end{split}\]</div>
</div>
</section>
<section id="corresponding-states">
<h4>Corresponding States<a class="headerlink" href="#corresponding-states" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">labellines</span><span class="w"> </span><span class="kn">import</span> <span class="n">labelLines</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">R</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Define styles for species</span>
<span class="n">style_for_species</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ar&quot;</span><span class="p">:</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s2">&quot;O2&quot;</span><span class="p">:</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">}</span>
<span class="n">label_for_species</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ar&quot;</span><span class="p">:</span> <span class="s2">&quot;Ar&quot;</span><span class="p">,</span> <span class="s2">&quot;O2&quot;</span><span class="p">:</span> <span class="s2">&quot;O$_2$&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="s2">&quot;H$_2$O&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">:</span> <span class="s2">&quot;CO$_2$&quot;</span><span class="p">}</span>
<span class="n">line_style_for_species</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ar&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;O2&quot;</span><span class="p">:</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="s2">&quot;-.&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">:</span> <span class="s2">&quot;:&quot;</span><span class="p">}</span>
<span class="n">color_for_temperature</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.9</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">:</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">}</span>
<span class="n">color_for_species</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ar&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;O2&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">:</span> <span class="s2">&quot;magenta&quot;</span><span class="p">}</span>

<span class="c1"># Paths to data files</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sa">f</span><span class="s2">&quot;../_static/section-04/isothermal-properties-for-</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">-Tr=</span><span class="si">{</span><span class="n">T_r</span><span class="si">}</span><span class="s2">.csv&quot;</span>
    <span class="k">for</span> <span class="n">species</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;argon&quot;</span><span class="p">,</span> <span class="s2">&quot;oxygen&quot;</span><span class="p">,</span> <span class="s2">&quot;water&quot;</span><span class="p">,</span> <span class="s2">&quot;carbon-dioxide&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">T_r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Load and plot data</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">paths</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Temperature (K)&quot;</span><span class="p">:</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;Pressure (bar)&quot;</span><span class="p">:</span> <span class="s2">&quot;P_bar&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume (m3/mol)&quot;</span><span class="p">:</span> <span class="s2">&quot;Vm&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P_bar&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e5</span>  <span class="c1"># Convert bar to Pa</span>
    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Vm&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">])</span>
    
    <span class="n">species</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;substance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">T_r</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Tr&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">color_for_temperature</span><span class="p">[</span><span class="n">T_r</span><span class="p">]</span>
    <span class="n">linestyle</span> <span class="o">=</span> <span class="n">line_style_for_species</span><span class="p">[</span><span class="n">species</span><span class="p">]</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$T_r = </span><span class="si">{</span><span class="n">T_r</span><span class="si">}</span><span class="s2">$&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
    
    <span class="n">line</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Pr&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Z&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
        <span class="n">labelLines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xvals</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># Create legend</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label_for_species</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">ls</span><span class="o">=</span><span class="n">line_style_for_species</span><span class="p">[</span><span class="n">s</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
                   <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">line_style_for_species</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>

<span class="c1"># Set labels and grid</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Reduced Pressure ($P_r = P / P_c$)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$Z$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s1">&#39;corresponding-states&#39;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-center" id="id2" style="width: 100%">
<img alt="../_images/59cb6f9f611363fe2e9c726bd2710fa01a1208afdf2e37e71a43b6e878e663b7.png" src="../_images/59cb6f9f611363fe2e9c726bd2710fa01a1208afdf2e37e71a43b6e878e663b7.png" />
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Compressibility factor <span class="math notranslate nohighlight">\(Z\)</span> of argon, oxygen, water, and carbon dioxide plotted over a range of reduced pressures for different reduced temperatures. These data illustrate how real gases exhibit similar trends when expressed in terms of their critical properties, in accordance with the principle of corresponding states.</span><a class="headerlink" href="#id2" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Redefining <span class="math notranslate nohighlight">\(V_\text{m}\)</span>, <span class="math notranslate nohighlight">\(P\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> as fractions <span class="math notranslate nohighlight">\(V_{\text{m},r}\)</span>, <span class="math notranslate nohighlight">\(P_r\)</span>, and <span class="math notranslate nohighlight">\(T_r\)</span> of their critical values:</p>
<div class="math notranslate nohighlight">
\[V_\text{m} = V_{\text{m},r} V_{\text{m},c}, \quad P = P_r P_c, \quad T = T_r T_c,\]</div>
<p>and substituting these definitions into Equation <a class="reference internal" href="#equation-van-der-waals-eos">(8)</a> reveals a significant result:</p>
<div class="math notranslate nohighlight" id="equation-van-der-waals-eos-corresponding-states">
<span class="eqno">(10)<a class="headerlink" href="#equation-van-der-waals-eos-corresponding-states" title="Link to this equation">#</a></span>\[\left( P_r + \frac{3}{V_{\text{m},r}^2} \right) \left( V_{\text{m},r} - \frac{1}{3} \right) = \frac{8}{3} T_r.\]</div>
<p>This result—called the principle of corresponding states—illustrates that the equations of state for all van der Waals fluids are alike when expressed relative to their critical properties.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Calculate the value of the compressibility factor for a van der Waals fluid at the critical point? Do you notice anything interesting?</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Complete Derivation of the Corresponding States Equation</p>
<p><strong>1. Substitute the Definitions of <span class="math notranslate nohighlight">\(V_\text{m}\)</span>, <span class="math notranslate nohighlight">\(P\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> Into Equation <a class="reference internal" href="#equation-van-der-waals-eos">(8)</a>:</strong></p>
<div class="math notranslate nohighlight">
\[\left( P_r P_c + \frac{a_\text{m}}{V_{\text{m},r}^2 V_{\text{m},c}^2} \right) \left( V_{\text{m},r} V_{\text{m},c} - b_\text{m} \right) = R T_r T_c.\]</div>
<p><strong>2. Divide Both Sides by <span class="math notranslate nohighlight">\(P_c V_{\text{m},c}\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[\left( P_r + \frac{a_\text{m}}{V_{\text{m},r}^2 V_{\text{m},c}^2 P_c} \right) \left( V_{\text{m},r} - \frac{b_\text{m}}{V_{\text{m},c}} \right) = \frac{R T_c}{P_c V_{\text{m},c}} T_r.\]</div>
<p><strong>3. Substitute the Definitions of <span class="math notranslate nohighlight">\(P_c\)</span>, <span class="math notranslate nohighlight">\(V_{\text{m},c}\)</span>, and <span class="math notranslate nohighlight">\(T_c\)</span> In Terms of <span class="math notranslate nohighlight">\(a_\text{m}\)</span>, <span class="math notranslate nohighlight">\(b_\text{m}\)</span>, and <span class="math notranslate nohighlight">\(R\)</span>:</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\left( P_r + \frac{a_\text{m}}{V_{\text{m},r}^2} \cdot \frac{1}{9 b_\text{m}^2} \cdot \frac{27 b_\text{m}^2}{a_\text{m}} \right) \left( V_{\text{m},r} - \frac{b_\text{m}}{3 b_\text{m}} \right) &amp;= R \cdot \frac{8 a_\text{m}}{27 b_\text{m} R} \cdot \frac{27 b_\text{m}^2}{a_\text{m}} \cdot \frac{1}{3 b_\text{m}} T_r \\
\left( P_r + \frac{3}{V_{\text{m},r}^2} \right) \left( V_{\text{m},r} - \frac{1}{3} \right) &amp;= \frac{8}{3} T_r.
\end{aligned}\end{split}\]</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter-01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="section-03.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">1.3. Ideal Gases</p>
      </div>
    </a>
    <a class="right-next"
       href="review.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Review</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deviations-from-ideal-behavior">Deviations from Ideal Behavior</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compressibility-factor">Compressibility Factor</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-fluid">Van der Waals Fluid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-equation-of-state">Van der Waals Equation of State</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#van-der-waals-isotherm">Van der Waals Isotherm</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-point">Critical Point</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#corresponding-states">Corresponding States</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert B. Wexler
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>